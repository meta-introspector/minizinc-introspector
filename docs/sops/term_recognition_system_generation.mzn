% MiniZinc Specification: Term Recognition System Generation âœ¨
% Conceptual Model based on SOP Poem ğŸ“œ and Quality Principles ğŸ“ˆ

% This model serves as a declarative specification for the term recognition system,
aligning with ISO 9000 (Quality Management ğŸ¯), GMP (Good Manufacturing Practices ğŸ­),
Six Sigma (Process Optimization âš™ï¸), and ITIL (Service Management ğŸ¤) principles.
% It defines the system's parameters, entities, and constraints, ensuring a controlled
% and predictable generation process.

% --- 1. System Parameters and Configuration ğŸ“Š ---
int: num_raw_terms; % Total terms in hierarchical_term_index.json ğŸŒ³
int: max_total_terms; % MAX_TOTAL_TERMS (from term_loader.rs) - Process Control Limit ğŸ›‘
int: max_terms_per_chunk; % MAX_TERMS_PER_CHUNK (from chunk_generator.rs) - Memory Efficiency Constraint ğŸ§ 
int: max_terms_per_dfa_file; % MAX_TERMS_PER_FILE (from vocabulary_dfa_generator/src/main.rs) - Modularity Constraint ğŸ§©

% --- 2. Data Flow and Entities â¡ï¸ ---
set of int: TermID = 1..num_raw_terms; % Universe of potential terms ğŸŒŒ
set of int: FilteredTermID; % Subset of TermID after filtering - Quality Gate âœ…
set of int: ChunkID; % Identifiers for generated term data chunks ğŸ“¦
set of int: GeneratedFileID; % Identifiers for generated JSON files ğŸ“„
set of int: DFAFileID; % Identifiers for generated DFA .rs files ğŸ¤–

% Variables representing properties of terms/chunks/files
array[TermID] of bool: is_junk_term; % True if term is junk - Defect Identification ğŸ›
array[FilteredTermID] of string: filtered_term_content; % Actual term strings - Data Integrity ğŸ›¡ï¸
array[ChunkID] of int: terms_in_chunk; % Number of terms in each chunk - Resource Allocation âš–ï¸
array[GeneratedFileID] of string: generated_file_name; % Name of generated JSON file - Traceability ğŸ”—
array[DFAFileID] of string: dfa_file_name; % Name of generated DFA .rs file - Functional Output ğŸš€

% --- 3. Constraints (from SOP logic) ğŸ”’ ---

% Filtering constraint: Filtered terms are a subset of raw terms
% Ensures only valid, non-junk terms proceed, adhering to quality standards.
constraint forall (t in FilteredTermID) (not is_junk_term[t]);

% Max total terms constraint: Prevents system overload and ensures scalability.
constraint card(FilteredTermID) <= max_total_terms;

% Chunking constraints: Optimizes memory usage and improves processing efficiency.
% Each chunk's size must respect max_terms_per_chunk (Six Sigma: process variation control)
constraint forall (c in ChunkID) (terms_in_chunk[c] <= max_terms_per_chunk);
% Total filtered terms must be distributed among chunks (ITIL: service delivery consistency)
constraint sum(c in ChunkID)(terms_in_chunk[c]) = card(FilteredTermID);

% DFA file generation constraint: Ensures modularity and manageability of generated code.
% Each DFA file's size must respect max_terms_per_dfa_file
% (Conceptual: terms are grouped into DFA files for efficient compilation and loading)

% Path configuration (conceptual, as MiniZinc doesn't handle file paths directly)
% These are external inputs to the system, defining the operational environment.
% string: home_dir_path; ğŸ 
% string: github_root_path; ğŸ™
% string: project_root_path; ğŸ“
% string: hierarchical_term_index_path; ğŸ“œ

% --- 4. Objectives (Conceptual) ğŸ¯ ---
% This section outlines desired outcomes and optimization goals, guiding continuous improvement.
% For example, minimizing memory usage could be conceptualized as minimizing max(terms_in_chunk)
% or minimizing the number of chunks for a given max_terms_per_chunk.
% Other objectives could include:
% - Minimize generation time â±ï¸
% - Maximize code reusability (by optimizing chunking for common patterns) â™»ï¸
% - Ensure traceability from raw term to generated file (ISO 9000) ğŸ”

% solve satisfy; % Or solve minimize/maximize if an objective is defined

% --- 5. Output (Conceptual) ğŸ“ˆ ---
% Defines key metrics for monitoring and quality assurance.
% output [
%   "Number of filtered terms: ", show(card(FilteredTermID)), "\n", % Process Yield
%   "Number of chunks: ", show(card(ChunkID)), "\n", % Modularity Metric
%   "Max terms in any chunk: ", show(max(terms_in_chunk)), "\n" % Peak Memory Load
% ];